<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Etichetta ATS - Stampa 10x5 cm Reale</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f7; padding: 20px; color: #1d1d1f; }
    .container { max-width: 420px; margin: 0 auto; }
    .card { background: white; border-radius: 18px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 30px; }
    .header { background: #007aff; color: white; padding: 18px; text-align: center; font-size: 20px; font-weight: 600; }
    .form { padding: 20px; }
    .radio-group { display: flex; justify-content: center; gap: 40px; margin-bottom: 25px; font-size: 16px; }
    .radio-group label { display: flex; align-items: center; gap: 8px; cursor: pointer; }
    .field { margin-bottom: 18px; }
    .field label { display: block; font-size: 15px; font-weight: 600; margin-bottom: 6px; color: #333; }
    .field input, .field select { width: 100%; padding: 14px 16px; border: 1px solid #d2d2d7; border-radius: 12px; font-size: 17px; background: #fff; }
    .field input:focus, .field select:focus { outline: none; border-color: #007aff; box-shadow: 0 0 0 3px rgba(0,122,255,0.2); }
    .btn { width: 100%; padding: 16px; background: #007aff; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 600; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; }
    .btn:hover { background: #0066cc; }

    @media print {
    @page {
        size: 100mm 50mm;      /* 10×5 cm  oppure 100mm 100mm per 10×10 */
        margin: 0;
        padding: 0;
    }
    
    html, body {
        margin: 0 !important;
        padding: 0 !important;
        width: 100mm !important;
        height: 50mm !important;   /* cambia in 100mm per formato 10×10 */
        overflow: hidden;
    }

    .etichetta {
        width: 100mm !important;
        height: 50mm !important;    /* cambia in 100mm per 10×10 */
        margin: 0 !important;
        padding: 5mm !important;    /* o quanto vuoi tu */
        page-break-after: always;
        box-sizing: border-box;
    }

    .etichetta.small {
        height: 50mm !important;
    }

    /* Nascondi tutto il resto */
    .card, .btn, .container > *:not(#anteprima) {
        display: none !important;
    }
}

.header-logo {
    border-bottom: 3px solid black;
    padding-bottom: 6px;
    margin-bottom: 6px;
    display: flex;
    justify-content: space-between;    /* sinistro e destro */
    align-items: center;
    min-height: 50px;                  /* dà spazio verticale */
    padding: 0 10px;                   /* margine interno sinistra/destra */
}

/* Logo ATS a sinistra */
.logo-principale {
    height: 42px;
    width: auto;
    object-fit: contain;
}

/* Icona commessa a destra */
.icon-commessa {
    height: 38px;           /* un po' più piccola del logo ATS */
    width: auto;
    object-fit: contain;
}
    .campo-data { border: 2px solid black; padding: 4px 8px; text-align: center; font-size: 16px; font-weight: bold; margin-bottom: 4px; }
    .riga-odp { display: flex; align-items: center; justify-content: space-between; flex-grow: 1; padding: 0 8px; }
    .odp { font-size: 28px; font-weight: bold; text-align: center; flex: 1; }
    .colli-pallet { font-size: 15px; font-weight: bold; text-align: right; white-space: nowrap; line-height: 1.3; }
    .dati-10x5 { font-size: 13.5px; font-weight: bold; line-height: 1.4; text-align: left; margin-left: 8px; margin-top: 2px; }
    .progressivo { text-align: center; font-size: 24px; font-weight: bold; margin: 8px 0; }
    .campo { border: 2px solid black; padding: 6px 8px; margin-bottom: 8px; }
    .label { font-size: 11px; font-weight: bold; }
    .valore { font-size: 17px; font-weight: bold; margin-top: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

.riga-id {
    display: flex;
    justify-content: space-between;
    width: 100%;
}

.colli-inline {
    font-weight: bold;
    margin-left: 10px;


.riga-odp {
    display: flex;
    align-items: center;
    gap: 6px; /* spazio tra ODP e numero */
    font-weight: bold;
}

.label-odp {
    font-size: 14px;
    font-weight: bold;
    
    
}
.riga-id {
    display: flex;
    justify-content: space-between;
    width: 100%;
}
.colli-inline {
    font-weight: bold;
}
/* ——— ANTEPRIMA A VIDEO BELLA E CHIARA ——— */
#anteprima {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;                    /* spazio tra le etichette */
    justify-content: center;
    padding: 30px 15px;
    background: #e2e8f0;         /* grigio-blu chiaro, molto leggibile */
    border-radius: 16px;
    margin-top: 20px;
    min-height: 200px;
}

.etichetta {
    flex: 0 0 100mm;              /* larghezza reale dell’etichetta */
    background: white;
    border: 4px solid #000;
    box-shadow: 0 8px 25px rgba(0,0,0,0.22);
    position: relative;
    page-break-after: always;     /* per sicurezza, ma non serve a video */
    transition: transform 0.2s, box-shadow 0.2s;
}

/* versione 10×5 */
.etichetta.small {
    height: 50mm !important;
}

/* versione 10×10 (default) */
.etichetta:not(.small) {
    height: 100mm !important;
}

/* piccolo effetto hover carino (solo desktop) */
@media (hover: hover) {
    .etichetta:hover {
        transform: translateY(-6px);
        box-shadow: 0 14px 30px rgba(0,0,0,0.3);
    }
}

/* numerino piccolo in alto a sinistra per contare le copie */
.etichetta::before {
    content: counter(etichetta);
    counter-increment: etichetta;
    position: absolute;
    top: -12px;
    left: -12px;
    background: #007aff;
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    font-weight: bold;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    z-index: 10;
}

/* reset contatore */
#anteprima { counter-reset: etichetta 1; }
   
</style>
</head>
<body>

<div class="container">
    <div class="card">
        <div class="header">Etichetta ATS - Magazzino</div>
        <div class="form">

            <div class="radio-group">
                <label><input type="radio" name="size" value="10x10" checked onchange="cambiaFormato()"> 10×10 cm</label>
                <label><input type="radio" name="size" value="10x5" onchange="cambiaFormato()"> 10×5 cm</label>
            </div>

            <div class="field"><label>Data:</label><input type="date" id="data" onchange="genera()"></div>

            <div class="field" id="commessaField">
                <label>Commessa:</label>
                <select id="commessa">
                    <option value="" selected disabled>Inserire Commessa</option>
                    <option value="VODAFONE-NTD">VODAFONE SpA - NTD</option>
                    <option value="VODAFONE-FLM">VODAFONE SpA - FLM</option>
                    <option value="INWIT">INWIT SpA</option>
                    <option value="ZAS">ZAS TRADING SRL</option>
                </select>
            </div>

            <div class="field" id="odpField" style="display:none;">
                <label>ODP:</label>
                <input type="text" id="odp" placeholder="es. 123456789" oninput="genera()">
            </div>

            <!-- DESTINO 10x10 -->
            <div class="field" id="destinoField">
                <label>Destino:</label>
                <input type="text" id="destino" placeholder="Seleziona destinazione" list="destinoList" oninput="validateDestino()">
                <datalist id="destinoList"></datalist>
            </div>

            <div class="field" id="locationField" style="display:none;">
                <label>Location:</label>
                <input type="text" id="location" placeholder="es. ITWXXXXXXX" oninput="genera()">
            </div>

            <div class="field">
                <label id="labelIndirizzo">Indirizzo:</label>
                <input type="text" id="indirizzo" placeholder="si compila automaticamente" oninput="genera()">
            </div>

            <div class="field"><label>Colli per pallet (es. 5,3,7):</label><input type="text" id="palletColli" placeholder="5,3,7" oninput="genera()"></div>

            <button class="btn" onclick="window.print()">Stampa Etichette</button>
            <button class="btn" style="background:#ff3b30;" onclick="resetCampi()">Reset Campi</button>
        </div>
    </div>

    <div id="anteprima"></div>
</div>

<script>
// DESTINAZIONI PER COMMESSA
const destinazioniPerCommessa = {
    "ZAS": [
        {destino:"1088 - MI",indirizzo:"VIALE LEONE TOLSTOJ, 47/A"},
    {destino:"97 OSPEDALE CONA FERRARA - FE",indirizzo:"VIA ALDO MORO, 8"},
    {destino:"ACQUAELLE - TA",indirizzo:"VIA UGO AMALDI, 4"},
    {destino:"AF CORSE - PC",indirizzo:"STR. FARNESIANA 242"},
    {destino:"AG LOGISTICA - MI",indirizzo:"VIA OLIVETTI 29/33"},
    {destino:"AGRUSTI - BA",indirizzo:"VIA TITO SCHIPA, 9"},
    {destino:"ALIMENTARI G-B EXPRESS - MI",indirizzo:"VIA VOLTA, 2"},
    {destino:"ALICART - GE",indirizzo:"VIA G. MARCONI 130"},
    {destino:"ALLUISAN - MN",indirizzo:"VIA ENRICO FERMI, 50"},
    {destino:"ARES PACKAGING - BS",indirizzo:"VIA DEGLI ARTIGIANI 6"},
    {destino:"ARGENTA - AL",indirizzo:"VIA DELL'ARTIGIANATO, 22/24 Z. IND. D3"},
    {destino:"ARGENTA - AN",indirizzo:"VIA GIOLITTI, 14"},
    {destino:"ARGENTA - AR",indirizzo:"VIA E.BERLINGUER, 36 (FRAZ. LEVANE)"},
    {destino:"ARGENTA - BA",indirizzo:"VIALE EUROPA 12"},
    {destino:"ARGENTA - BL",indirizzo:"LOC. PRADENICH, 18"},
    {destino:"ARGENTA - BO",indirizzo:"VIA CICOGNA, 30-32"},
    {destino:"ARGENTA - BO 2",indirizzo:"VIA R. BACCHINI, 6/D"},
    {destino:"ARGENTA - BR",indirizzo:"VIALE DELL ARTIGIANATO SNC"},
    {destino:"ARGENTA - BS",indirizzo:"VIA CRISTOFORO COLOMBO, 31"},
    {destino:"ARGENTA - GE",indirizzo:"VAL LERONE, 132"},
    {destino:"ARGENTA - LO",indirizzo:"VIA ADA NEGRI, 1"},
    {destino:"ARGENTA - MI",indirizzo:"VIA COMO, 10/A"},
    {destino:"ARGENTA - MN",indirizzo:"VIA I° MAGGIO, 35"},
    {destino:"ARGENTA - MO",indirizzo:"VIA EINSTEIN, 6"},
    {destino:"ARGENTA - PD",indirizzo:"VIA PARINI, 4"},
    {destino:"ARGENTA - PG",indirizzo:"VIA DELLA SEGALE 49, LOC BALANZANO"},
    {destino:"ARGENTA - PI",indirizzo:"VIA SPAGNA 11"},
    {destino:"ARGENTA - PO",indirizzo:"VIA FRANCO VANNETTI DONNINI 53/2"},
    {destino:"ARGENTA - PR",indirizzo:"VIA ROMAGNOLI 24"},
    {destino:"ARGENTA - PR 2",indirizzo:"VIA SEGRE, 7/A"},
    {destino:"ARGENTA - PV",indirizzo:"VIA LEONARDO DA VINCI, 5"},
    {destino:"ARGENTA - RM",indirizzo:"VIA LUCREZIA ROMANA 115"},
    {destino:"ARGENTA - TO",indirizzo:"VIA MASSIMO D'ANTONA 25/27"},
    {destino:"ARGENTA - TV",indirizzo:"VIA PADANIA, 71"},
    {destino:"ARGENTA - VA",indirizzo:"VIA MARCO POLO, 12"},
    {destino:"ARGENTA - VE",indirizzo:"VIA PAGANELLO, 25"},
    {destino:"ARGENTA - VR",indirizzo:"VIA RODOLFO SPINETA, 1782"},
    {destino:"ASSO-CATERING - PG",indirizzo:"VIA DEL LAVORO, 37"},
    {destino:"AUTOPORTO - IM",indirizzo:"AUTOPORTO"},
    {destino:"AVANZINI LOGISTICA - VR",indirizzo:"VIA SPINELLI SNC (BLOCCO D)"},
    {destino:"BAGLIVO FRANCESCO - BR",indirizzo:"CONTRADA LEI, 2"},
    {destino:"BAIT DI ZHAO NAXIN - MI",indirizzo:"VIA NILDE IOTTI, 9"},
    {destino:"BAR NAR DOO",indirizzo:"38 MAJKE JEVROSIME ST."},
    {destino:"BAR OSP. GENOVA - GE",indirizzo:"LARGO R. BENZI, 10"},
    {destino:"BARONCINI - RO",indirizzo:"VIA A. AZZI 889"},
    {destino:"BI.VI - CO",indirizzo:"VIA S.GIOVANNI BOSCO N.3"},
    {destino:"BI.VI. - MI",indirizzo:"VIA MAGENTA 77 EDIFICIO 20/D"},
    {destino:"BIO PACK - MI",indirizzo:"VIA C. CATTANEO, 2"},
    {destino:"BIO PACKAGING SOLUTION - CA",indirizzo:"VIA DELL'ARTIGIANATO 15"},
    {destino:"BLU MAPUL - LE",indirizzo:"SS275 MAGLIE LEUCA , Z.I SAN CASSIANO"},
    {destino:"BLUE CITY - TN",indirizzo:"VIA ALTO ADIGE 242"},
    {destino:"BOLLACCHINO - FG",indirizzo:"C.DA STERPARO MASCIA, LOTTO 35 ZONA IND."},
    {destino:"BSA - SS",indirizzo:"VIA ISRAELE, 4 (ZONA INDUSTRIALE)"},
    {destino:"C.C.M - AN",indirizzo:"VIA DELLA SBROZZOLA, 20/A"},
    {destino:"C.C.M - MO",indirizzo:"VIA F. MALAVOLTI, 12"},
    {destino:"C4 AOU SALERNO RUGGI - SA",indirizzo:"LARGO CITTA DI IPPOCRATE"},
    {destino:"C9 OSPEDALI EBOLI - SA",indirizzo:"PIAZZA SCUOLA MEDICA SALERNITANA"},
    {destino:"CARTA E IMBALLAGGI - PA",indirizzo:"VIA VITTORIO DUCROT, 18/20"},
    {destino:"CARTA E IMBALLAGGI S.P.A - ME",indirizzo:"VIA ETTORE MAJORANA SNC"},
    {destino:"CARTA E IMBALLAGGI S.P.A - RG",indirizzo:"S.S. 115 KM. 315,6 - CONTRADA MAIORANA"},
    {destino:"CARTA IDEA - RM",indirizzo:"VIA GERMANIA, 31/A"},
    {destino:"CARTA IN - PA",indirizzo:"VIA F.M.ALIAS 2/F"},
    {destino:"CARTALPLAST - GE",indirizzo:"VIA ANTONIO GANDIN, 86N"},
    {destino:"CARTARIA LUGHESE - RA",indirizzo:"VIA LUNGA, 10"},
    {destino:"CARTOWORLD - CH",indirizzo:"ZONA ARTIG. POLERCIA, SNC"},
    {destino:"CARTOPLAST - CA",indirizzo:"VIA MEUCCI, 12"},
    {destino:"CASIO - TA",indirizzo:"VIA DEL TRATTURELLO TARANTINO, 5"},
    {destino:"CATERLINE - VA",indirizzo:"VIA ZOCCHETTA, 40"},
    {destino:"CC OSPEDALE VALLO DELLA LUCANIA - SA",indirizzo:"VIA FRANCESCO CAMMAROTA"},
    {destino:"CC01 OSPEDALE DI POLLA - SA",indirizzo:"VIA LUIGI CURTO"},
    {destino:"CE.DI. GENERI VARI - MB",indirizzo:"VIA VIGANO' 140"},
    {destino:"CEDI NO FOOD IPERAL - SO",indirizzo:"VIA NAZIONALE 1468"},
    {destino:"CENTRO COTTURA BOLLATE - MI",indirizzo:"VIA TORINO,13"},
    {destino:"CENTRO COTTURA GARBAGNATE MILANESE - MI",indirizzo:"VIA DELLE BRUGHIERE 24"},
    {destino:"CENTRO COTTURA LEGNARO - PD",indirizzo:"VIA E. FERMI, 14"},
    {destino:"CENTRO RISTORO VALDIPESA - FI",indirizzo:"VIA CIMABUE 18"},
    {destino:"CF CARTA - SA",indirizzo:"VIA G.ALBERTO DALLA CHIESA, 39"},
    {destino:"CHS - BO",indirizzo:"VIA CA' DELL'ORBO NORD, 11"},
    {destino:"CHS - BO 2",indirizzo:"VIA CHIESACCIA, 40"},
    {destino:"CHS - BO 3",indirizzo:"VIA G. MATTEOTTI, 21"},
    {destino:"CHS - CR",indirizzo:"VIA 11 SETTEMBRE 2001, 8"},
    {destino:"CHS - CR 2",indirizzo:"VIA MARZABOTTO, 16"},
    {destino:"CIGI SERVICE - MI",indirizzo:"VIA DELLA VECCHIA CHIMICA 5/A"},
    {destino:"COGEPACK - BG",indirizzo:"VIA MONTE NEVOSO 12"},
    {destino:"COMMERCIALE ABRUZZO - PE",indirizzo:"VIA DELLA BONIFICA 10/B, C/O MAGAZZ. D'AMICO TRAS."},
    {destino:"CRISTIANPACK - AN",indirizzo:"VIA SAN SABINO 5"},
    {destino:"D GROUP - OT",indirizzo:"VIA GABON 88"},
    {destino:"DAC - BS",indirizzo:"VIA G. MARCONI 15"},
    {destino:"DAC - RI",indirizzo:"VIA DELL'ELETTRONICA"},
    {destino:"DAC S.P.A. - SAVIO - RA",indirizzo:"VIA SANTERNO 8"},
    {destino:"DADA - MI",indirizzo:"VIA PAVIA, 23"},
    {destino:"DADA - MI 2",indirizzo:"VIA TIRSO, 2/4"},
    {destino:"DAGI - TA",indirizzo:"CONTRADA CASELLONE"},
    {destino:"DALLIFOOD - TE",indirizzo:"VIA ISIDORI E LEPIDO FACII SNC"},
    {destino:"DE TULLIO - LE",indirizzo:"VIA FINLANDIA, 5 Z.I."},
    {destino:"DECART - NA",indirizzo:"VIA FORMIELLO, 10"},
    {destino:"DEPOSITO A - SA",indirizzo:"VIA NOCELLETO 24"},
    {destino:"DEPOSITO FOOD BELFIORE - VR",indirizzo:"VIALE DEL LAVORO 20"},
    {destino:"DETERCART SUD SAS - SA",indirizzo:"VIA G.PUCCINI LOC.PONTE BARIZZO"},
    {destino:"DETERCHIMICA - BS",indirizzo:"VIA VERDI, 94"},
    {destino:"DI GIOVANNI LUIGI - CL",indirizzo:"VIA CARLO ALBERTO DALLA CHIESA SNC"},
    {destino:"DISTRIBUZIONE CLEMENTE - TA",indirizzo:"VIA Y. RABIN, SNC"},
    {destino:"DITTA AMORE - TN",indirizzo:"VIA PARTELI, 29"},
    {destino:"E1 OSP. SORA - FR",indirizzo:"LOCALITA SAN MARCIANO"},
    {destino:"E8 C.C. ALGHERO - SS",indirizzo:"VIA GUIXERA 7"},
    {destino:"EASY SERVICE - VA",indirizzo:"VIA BRUNICO 88"},
    {destino:"EASY SERVICE - VA 2",indirizzo:"VIA LAURANA, 12"},
    {destino:"EASY SERVICE - VA 3",indirizzo:"VICOLO EUPILI 14"},
    {destino:"ECO CARTA - PA",indirizzo:"VIA POLITO 3/A"},
    {destino:"ELIOR - PC",indirizzo:"VIA FRANCESCO MARIA BAZZANI 63/63"},
    {destino:"ELIOR RISTORAZIONE - AL",indirizzo:"VIA STEFANO GUAZZO 15/A"},
    {destino:"ELIOR RISTORAZIONE - MI",indirizzo:"VIA PRIVATA VENEZIA GIULIA 5/A"},
    {destino:"EMMECICARTA - RM",indirizzo:"VIA TINA LORENZONI, 7"},
    {destino:"ESSEMME PACK - FR",indirizzo:"VIA ANIME SANTE, SNC"},
    {destino:"ESSEMME PACK - FR 2",indirizzo:"VIA DEI VOLSCI,126"},
    {destino:"EUROCART - BO",indirizzo:"VIA PROVINCIALE VECCHIA, 4/A"},
    {destino:"F.R. SERVICE - CO",indirizzo:"VIA SAN GIOVANNI BOSCO, 3"},
    {destino:"FGF FORNITURE - TO",indirizzo:"VIA IVREA 6"},
    {destino:"FGM - BA",indirizzo:"VIA SALVEMINI, N°10"},
    {destino:"FI.VE. DISTRIBUZIONE - RA",indirizzo:"VIA DELL'INDUSTRIA, 6"},
    {destino:"FIORINO - ME",indirizzo:"ZIR DIR/A GIAMMORO"},
    {destino:"FMC - MI",indirizzo:"V GATTAMELATA 5 PAD17 GATE13"},
    {destino:"FOODPACK.GREEN - SR",indirizzo:"VIALE EDOARDO GARRONE, 5"},
    {destino:"FP DI PELLICANI FRANCESCO - BA",indirizzo:"VIA GUIDO ROSSA 33"},
    {destino:"FP IMBALLAGGI - BA",indirizzo:"VIA GUIDO ROSSA, 33N"},
    {destino:"FRESCO FOOD - PU",indirizzo:"VIA BOCCA DI STELLA, 10/21"},
    {destino:"FRIULCARTA - PN",indirizzo:"ZONA INDUSTRIALE COSA, 17"},
    {destino:"G.F.E. - SP",indirizzo:"LOCALITA CAMPI"},
    {destino:"GEDIPACK - LE",indirizzo:"VIA MACCHIAIOLI, 61"},
    {destino:"GEGEL - CH",indirizzo:"ZONA IND.LE SETTORE A"},
    {destino:"GIMA - LE",indirizzo:"Z.I KM 1"},
    {destino:"GMF - PG",indirizzo:"STRADA DEI LOGGI, 48"},
    {destino:"GOODMORNING PAPER - CE",indirizzo:"INTERPORTO SUD EUROPA P.A CAPANNONE, 7.1"},
    {destino:"GOODMORNING PAPER - VR",indirizzo:"VIA ADIGE 2"},
    {destino:"GOODMORNING PAPER - VR 2",indirizzo:"VIA DELL'ARTIGIANATO 20"},
    {destino:"GRAN FONDO STRADE BIANCHE - SI",indirizzo:"STRADA DI SELVAMAGGIO, N. 72/C"},
    {destino:"GREEN EOS - AT",indirizzo:"VIA MUSANZIA, 25/27"},
    {destino:"GRUPPO UNO C - BS",indirizzo:"VIA GAVARDINA SOPRA, 78/80"},
    {destino:"HAO YUN SUN - RM",indirizzo:"VIA SAN ROMANO IN GARFAGNANA, 32"},
    {destino:"HAOYUN ROMA - RM",indirizzo:"VIA DELLE IDROVORE DELLA MAGLIANA 73"},
    {destino:"HORECA DELIVERY - CE",indirizzo:"VIA APPIA 254"},
    {destino:"HORECA DELIVERY - CE 2",indirizzo:"VIA DOMENICO GENTILE 90"},
    {destino:"HYGIEN TECH - RM",indirizzo:"VIALE ALEXANDRE GUSTAVE EIFFEL, 100"},
    {destino:"IANNELLO VENDING - ME",indirizzo:"VIA LIBERTA', 1"},
    {destino:"IGROX - VA",indirizzo:"VIA SAMPIETRO 174"},
    {destino:"IL TULIPANO - PN",indirizzo:"VIA VALCUNSAT, 6/8"},
    {destino:"INCARTATUTTO - PG",indirizzo:"VIA ABRUZZO, 1"},
    {destino:"INNOVA - RM",indirizzo:"VIA NARO, 10"},
    {destino:"ITTICA TRADE - MI",indirizzo:"VIA CASSANESE, 1"},
    {destino:"JO BAR OSP. DEL MARE - NA",indirizzo:"VIA ENRICO RUSSO, 11"},
    {destino:"KING - RM",indirizzo:"VIA DEL FOSSO DI TOR TRE TESTE 91-97"},
    {destino:"KUSSTATSCHER - BZ",indirizzo:"SAUDERS 36"},
    {destino:"LA FENICE - MI",indirizzo:"VIA CARLO FARINI 56"},
    {destino:"LADISA - BA",indirizzo:"VIA LINDEMANN 5/3-5/4 ZONA ASI BARI"},
    {destino:"LADISA - RM",indirizzo:"VIA DI CERVARA"},
    {destino:"LICART - NU",indirizzo:"S.S. 125 KM.127,800 Z.I."},
    {destino:"LIMONGELLI - BR",indirizzo:"VIA RICCARDO MORETTI, 2"},
    {destino:"LOGISTICA EVO - BA",indirizzo:"VIA DEI GERANI, 15"},
    {destino:"M&M LOG - BI",indirizzo:"STRADA DEL CANCHIOSO SNC"},
    {destino:"MA.IN.CART - UD",indirizzo:"VIA AGNELLI, 10"},
    {destino:"MA.IN.CART - UD 2",indirizzo:"VIA DEGLI ARTIGIANI OVEST 27"},
    {destino:"MAESTRIPIERI - GE",indirizzo:"VIA FRATELLI CANEPA, 134 B"},
    {destino:"MAG.GENERI VARI - VR",indirizzo:"VIA P.VASSANELLI 21/23"},
    {destino:"MAG.GENERI VARI 2 - VR",indirizzo:"VIA CA' DI MAZZE'"},
    {destino:"MAGAZZ. ARSAGO SEPRIO - VA",indirizzo:"VIA CARDUCCI 23"},
    {destino:"MAGAZZ. LUCCA - LC",indirizzo:"VIA DELLE PIASTRE SNC"},
    {destino:"MAGAZZINI SCATIGNA - TA",indirizzo:"VIA MOTTOLA KM 2,200 Z.I"},
    {destino:"MAGAZZINO SDG - VR",indirizzo:"VIA DELLE COLOMBARE, 1-2"},
    {destino:"MALBANIA PACKING S.P.A. - RM",indirizzo:"VIA FERDINANDO NERI, 86"},
    {destino:"MAREVIVO - LE",indirizzo:"VIA PANORAMICA S.N.C."},
    {destino:"MARTUCCI CARTA - BR",indirizzo:"VIA DELL'INDUSTRIA, 26"},
    {destino:"MAXIGOURMET - BG",indirizzo:"VIA VEZZE 46/48/50"},
    {destino:"MC - BS",indirizzo:"VIA SAN ZENO 400"},
    {destino:"MELAMANGIO - BO",indirizzo:"VIA GUIDO ROSSA 5/2"},
    {destino:"MM LOG - VC",indirizzo:"STRADA PROVINCIALE TORINO-SVIZZERA SNC"},
    {destino:"MONDIALCHIMICART - FE",indirizzo:"VIA A. MEUCCI 9/A"},
    {destino:"MONDOFFICE - BI",indirizzo:"VIA PER GATTINARA, 17"},
    {destino:"MONTANARO DISTRIBUZIONE - TA",indirizzo:"VIA MONTI DEL DUCA H 165"},
    {destino:"MONTECHIMICA - PT",indirizzo:"VIA FONDA, 1"},
    {destino:"MONTESERVICE - FO",indirizzo:"VIA RAFFAELE CADORNA, 77"},
    {destino:"MSG - VI",indirizzo:"VIA TOMMASO DAL MOLIN 6/B"},
    {destino:"MUNDO - NA",indirizzo:"VIA CIRCUNVALLAZIONE ESTERNA, SNC"},
    {destino:"NAPI CHEMICAL - CH",indirizzo:"C.DA TAMARETE, SN Z.ARTIGIANALE"},
    {destino:"NAPI CHEMICAL - CH",indirizzo:"CONTRADA SANTA ELENA Z.I."},
    {destino:"NEW PACKAGING - LE",indirizzo:"VIA MASCAGNI, 28"},
    {destino:"NEW PACKAGING - PC",indirizzo:"VIA ZUCCHERIFICIO, 3"},
    {destino:"NQ OSPEDALE VOGHERA - PV",indirizzo:"VIA VOLTURNO, 14"},
    {destino:"NUOVA - MI",indirizzo:"VIA DI VITTORIO 20/E"},
    {destino:"NUOVA INCART - TO",indirizzo:"VIA KARCHER, 49"},
    {destino:"OLIVETTO RINO - PD",indirizzo:"VIA TERRADURA 106"},
    {destino:"OVERCOM - GE",indirizzo:"VIA BORZOLI 109 L ROSSO"},
    {destino:"PACKING - FI",indirizzo:"VIA FILIPPO BRUNELLESCHI 5/A"},
    {destino:"PAREDES ITALIA - AL",indirizzo:"STR. VICINALE MONTADA DELL'ALBERO"},
    {destino:"PASTORINO - GE",indirizzo:"VIA ACQUASANTA, 196"},
    {destino:"PEFIM - NA",indirizzo:"VIA GUGLIELMO MARCONI 26"},
    {destino:"PENTA CARTA 2000 - RM",indirizzo:"VIA DEL PONTE PISANO, 92/94"},
    {destino:"PERPULIRE - AL",indirizzo:"VIA DELL INDUSTRIA 36"},
    {destino:"PERPULIRE - CA",indirizzo:"SS 131 EX KM 7,300"},
    {destino:"PERPULIRE - ME",indirizzo:"VIA ORETO 34"},
    {destino:"PERPULIRE - ME 2",indirizzo:"ZONA ARTIGIANALE LA FIUMARA, 11"},
    {destino:"PERPULIRE - MI",indirizzo:"VIA LAZIO, 15"},
    {destino:"PERPULIRE - RM",indirizzo:"VIA MELIBEO 90"},
    {destino:"PERPULIRE - TO",indirizzo:"VIA GORETTA, 96/A"},
    {destino:"PIERRE DISTRIBUZIONE - AV",indirizzo:"VIALE TERZO MILLENNIO SNC"},
    {destino:"PLANET CARTA - PE",indirizzo:"VIA LUCIANI, 13"},
    {destino:"PLANT CARTA - PE",indirizzo:"VIALE KENNEDY, 29"},
    {destino:"PLASTIK ORO - BA",indirizzo:"IL BARICENTRO LOTTO 14/A MOD 7-8"},
    {destino:"PLUSTIK SERVICE - RM",indirizzo:"VIA GIACOMO PERONI,130"},
    {destino:"POOL PACK - LE",indirizzo:"STRADA COMUNALE ANTICA DI ACQUARICA Z.PIP, 81"},
    {destino:"POOL PACK CAMPANIA - SA",indirizzo:"C/DA QUERCIA 4"},
    {destino:"POOL PACK NORD OVEST - GE",indirizzo:"VIA B. PARODI 274/A"},
    {destino:"POOL PACK NORD OVEST - NO",indirizzo:"VIA BORGOMANERO 92 BIS"},
    {destino:"POOL PACK NORD OVEST - TO",indirizzo:"C.SO SAVONA 51"},
    {destino:"PRESENT-MORE - BG",indirizzo:"VIA VIANI, 42"},
    {destino:"PRO.DE.C MASTER PACKING - MS",indirizzo:"VIA GUIDO ROSSA"},
    {destino:"PROFESSIONAL PRODUCTS - RM",indirizzo:"VIA LIDIA BIANCHI, 7"},
    {destino:"PROFOOD - IS",indirizzo:"VIA COLONIA GIULIA, 106"},
    {destino:"PROGETTO PACKING - AP",indirizzo:"VIA 8 MARZO, 17"},
    {destino:"PROGIDA TRAVERSA 2 - BA",indirizzo:"S.S 100 KM 18 C/O IL BARICENTRO"},
    {destino:"PRVCOM - RE",indirizzo:"VIA MARTIRI DI CERVAROLO, 59"},
    {destino:"PULIVENETA - RO",indirizzo:"VIA DEL COMMERCIO, 24"},
    {destino:"PUNTO CARTA - BA",indirizzo:"VIA GIGANTE N°118"},
    {destino:"PUNTO COMUNE - PU",indirizzo:"VIA TOSCANA, 51"},
    {destino:"PUNTOCARTA - PE",indirizzo:"VIA VERROTTI, 61/A"},
    {destino:"RB FORNITURE - TI",indirizzo:"VIA URèNN 27A"},
    {destino:"RF DISTRIBUZIONE - SA",indirizzo:"VIA ANDREA VILLANI 8"},
    {destino:"RISTORALL - LE",indirizzo:"VIA CATANZARO, 12"},
    {destino:"RISTORAZIONE FUTURA - BO",indirizzo:"INTERPORTO COMPARTO 10.3"},
    {destino:"ROMANELLA PROFESSIONAL - CB",indirizzo:"C.DA SELVA PIANA, 19"},
    {destino:"ROSSETTO GROUP - MN",indirizzo:"VIA VILLANOVA DE BELLIS, 43/A"},
    {destino:"S.AXO SERVICE - RM",indirizzo:"VIA AMEDEO CRIVELLUCCI 7"},
    {destino:"SACI PROFESSIONAL - PG",indirizzo:"VIA CRISTOFORO CECCI SNC"},
    {destino:"SAGICART - TO",indirizzo:"VIALE DEI MARESCH, 24I"},
    {destino:"SANISYSTEM - BS",indirizzo:"VIA G. DI VITTORIO, 41"},
    {destino:"SAREM - RM",indirizzo:"VIA DEL CASALE SANTARELLI, 89/A"},
    {destino:"SCATOLIFICIO DEL GARDA - VR",indirizzo:"VIA COLOMBARE 1"},
    {destino:"SCATOLIFICIO DEL GARDA - VR 2",indirizzo:"VIA SOTTO SENGIA, 17"},
    {destino:"SCATOLIFICIO DEL GARDA S.P.A. - VR",indirizzo:"VIA MANTOVANA, 20"},
    {destino:"SELECTA ITALIA - CT",indirizzo:"STRADA XI ZONA IND.LE ALL'INCROCIO CON STRADA V"},
    {destino:"SELEZIONE CATERING - MI",indirizzo:"VIA LAZIO 10/05"},
    {destino:"SELEZIONE CATERING - MI 2",indirizzo:"VIA MARCHESINA 36"},
    {destino:"SELEZIONE CATERING - NA",indirizzo:"VIA CUPA SAN ROCCO Z.IND.PIP"},
    {destino:"SELEZIONE CATERING - NA 2",indirizzo:"VIA SANTA MARIA DEL PIANTO TORRE 5 SNC"},
    {destino:"SETTELUNE - RE",indirizzo:"VIA PRAMPOLINI 12/A"},
    {destino:"SEVEN - TN",indirizzo:"CORSO CENTRALE 40"},
    {destino:"SPRINT - LE",indirizzo:"VIA FRA' SILVESTRO CALIA, 22"},
    {destino:"STE.VA. PACKAGING - CA",indirizzo:"STRADA PROVINCIALE KM 2,900"},
    {destino:"SUITE 360 - RM",indirizzo:"VIA EMPOLITANA KM 6, 800"},
    {destino:"SUPERMERCATI MARTINELLI - VR",indirizzo:"VIALE DEL LAVORO, 11A"},
    {destino:"SUPERMERCATI VISOTTO - TV",indirizzo:"VIA CHERSO, 16/A"},
    {destino:"T1 OSP. FEDERICO II - NA",indirizzo:"VIA SERGIO PANSINI, 5"},
    {destino:"T2 P.O - NA",indirizzo:"VIA DOMENICO CACCIOPPOLI"},
    {destino:"TC CENTRO COTTURA MONTESILVANO - PE",indirizzo:"VIA G. VERROTTI, 23"},
    {destino:"TIBERI DISTRIBUZIONE - MC",indirizzo:"VIA G. ROSSINI, 63"},
    {destino:"TN OSP. GARBAGNATE MILANESE - MI",indirizzo:"VIA FORLANINI 95"},
    {destino:"TUTTOCARTA - CH",indirizzo:"VIA PADRE UGO FRASCA"},
    {destino:"TUTTOCARTA - SI",indirizzo:"VIA DELLA REPUBBLICA, 3 LOC. S.MARTINO"},
    {destino:"UN MONDO DI OFFERTE - SA",indirizzo:"VIA DELLE CORTI AREA PI, 10"},
    {destino:"UNIGROUP - SR",indirizzo:"VIALE EDOARDO GARRONE, 3"},
    {destino:"VALENTE V&G - BA",indirizzo:"STRADA COMUNALE NICOLA TASSELLI"},
    {destino:"VALORE ITALIA - FR",indirizzo:"VIA ISONZO, 19"},
    {destino:"VALORE ITALIA - FR 2",indirizzo:"VIALE GRECIA, 4A-4B"},
    {destino:"VERCELLI VG - 5081 - VC",indirizzo:"VIA CESARE LIBANO 7"},
    {destino:"VITANTONIO - SA",indirizzo:"LOCALITA MALAGENIA-ZONA IND."},
    {destino:"VP CENTRO CONFEZIONAMENTO VERCELLI - VC",indirizzo:"VIA BORASIO, 8"},
    {destino:"VV OSP. AORN CARDARELLI - NA",indirizzo:"VIA A. CARDARELLI, 9"},
    {destino:"WD OSP. ORDINE MAURIZIANO TORINO - TO",indirizzo:"VIA MAGELLANO, 1"},
    {destino:"YUZU - RA",indirizzo:"VIA GIUSTI, 8"},
    {destino:"ZANGA - PA",indirizzo:"VIA S. ALDISIO 1/A"},
    {destino:"ZANGA FOOD - PA",indirizzo:"VIALE STRASBURGO, 205"},
    {destino:"ZANGALORO - PA",indirizzo:"VIALE STRASBURGO 354"},
    {destino:"ZAS TRADING SRL - MN",indirizzo:"VIA FRATELLI BANDIERA 18"},
    {destino:"ZERILLI - TP",indirizzo:"CONTRADA CIAVOLO 147/A"},
    {destino:"ZETAPACK - TN",indirizzo:"VIA MORIELLE, 34"}
    ],
    "VODAFONE-NTD": [],
    "VODAFONE-FLM": [],
    "INWIT": []
};

// ICONE COMMESSE (aggiungi i tuoi link)
const iconeCommessa = {
    "VODAFONE-NTD": "https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/3ce9084239885145e00c0fffb5551103814ffdcf/Fastweb_%2B_Vodafone_logo.png",
    "VODAFONE-FLM": "https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/3ce9084239885145e00c0fffb5551103814ffdcf/Fastweb_%2B_Vodafone_logo.png",
    "INWIT": "https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/a6818037dcd5d038508a396f155ce4c9eb23f5bb/INWIT_logo_(2020-present).png",
    "ZAS": "https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/refs/heads/main/logo-zas.jfif"
};

// Imposta data odierna
document.getElementById("data").value = new Date().toISOString().split('T')[0];

// CAMBIA FORMATO 10x10 / 10x5
function cambiaFormato() {
    const piccolo = document.querySelector('input[name="size"]:checked').value === "10x5";

    document.getElementById("commessaField").style.display = piccolo ? "none" : "block";
    document.getElementById("odpField").style.display = piccolo ? "block" : "none";
    document.getElementById("destinoField").style.display = piccolo ? "none" : "block";
    document.getElementById("locationField").style.display = piccolo ? "block" : "none";

    document.getElementById("labelIndirizzo").textContent = piccolo ? "ID Scheda:" : "Indirizzo:";
    document.getElementById("indirizzo").readOnly = !piccolo;
    document.getElementById("indirizzo").placeholder = piccolo ? "es. 123456789" : "si compila automaticamente";

    if (piccolo) {
        document.getElementById("indirizzo").value = "";
        document.getElementById("location").value = "";
    } else {
        document.getElementById("destino").value = "";
        document.getElementById("indirizzo").value = "";
    }

    genera();
}

// AGGIORNA LISTA DESTINAZIONI PER COMMESSA
function aggiornaListaDestinazioni() {
    const commessa = document.getElementById("commessa").value;
    const lista = destinazioniPerCommessa[commessa] || [];
    const datalist = document.getElementById("destinoList");
    datalist.innerHTML = "";
    lista.forEach(d => {
        const option = document.createElement("option");
        option.value = d.destino;
        datalist.appendChild(option);
    });
    aggiornaIcona();
}

// VALIDAZIONE DESTINO 10x10
function validateDestino() {
    const commessa = document.getElementById("commessa").value;
    const lista = destinazioniPerCommessa[commessa] || [];
    const input = document.getElementById("destino").value;

    const trovato = lista.find(d => d.destino === input);
    if (trovato) {
        document.getElementById("indirizzo").value = trovato.indirizzo;
    } else {
        document.getElementById("indirizzo").value = "";
    }

    genera();
}

// AGGIORNA ICONA COMMESSA
function aggiornaIcona() {
    const commessa = document.getElementById("commessa").value;
    const icona = iconeCommessa[commessa] || "";
    const iconElem = document.querySelector(".icon-commessa");
    if (!iconElem) return;
    iconElem.src = icona;
}

// GENERA ANTEPRIMA
function genera() {
    const anteprima = document.getElementById("anteprima");
    anteprima.innerHTML = "";

    let data = document.getElementById("data").value || new Date().toISOString().split('T')[0];
    data = data.split("-").reverse().join("/");

    const palletColliInput = document.getElementById("palletColli").value.trim();
    let palletColli = palletColliInput ? palletColliInput.split(",").map(n => parseInt(n.trim())) : [1];

    const piccolo = document.querySelector('input[name="size"]:checked').value === "10x5";

    const testoPrincipale = piccolo ? (document.getElementById("odp").value || "—") : (document.getElementById("commessa").value || "—");
    const location = piccolo ? (document.getElementById("location").value || "—") : (document.getElementById("destino").value || "—");
    const idscheda = document.getElementById("indirizzo").value.trim() || "—";

    let idx = 0;
    for (let p = 0; p < palletColli.length; p++) {
        for (let c = 1; c <= palletColli[p]; c++) {
            const prog = `Pallet: ${p+1}/${palletColli.length} | Colli: ${c}/${palletColli[p]}`;

            const et = document.createElement("div");
            et.className = "etichetta" + (piccolo ? " small" : "");

            const iconHTML = piccolo ? "" : `<img src="${iconeCommessa[document.getElementById("commessa").value] || ""}" class="icon-commessa">`;

            if (piccolo) {
               const iconaCommessaUrl = iconeCommessa[document.getElementById("commessa").value] || "";
                et.innerHTML = `
                    <div class="header-logo">
     <img src="https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/refs/heads/main/logo%20ats.jpg" class="logo-principale" alt="ATS">
     ${iconaCommessaUrl ? `<img src="${iconaCommessaUrl}" class="icon-commessa" alt="Commessa">` : ''}
 </div>

        <div class="campo-data">${data}</div>
        <div class="riga-odp">
            <div class="label-odp">ODP</div>
            <div class="odp">${testoPrincipale}</div>
        </div>
        <div class="dati-10x5">
            Location: ${location}<br>

            <div class="riga-id">
                <span>ID Scheda: ${idscheda}</span>
                <span class="colli-inline">${prog}</span>
            </div>
        </div>
    `;
} else {
               const iconaCommessaUrl = iconeCommessa[document.getElementById("commessa").value] || "";
                et.innerHTML = `
                    <div class="header-logo">
                        <img src="https://raw.githubusercontent.com/Daniele1995-design/WebAppSap/refs/heads/main/logo%20ats.jpg" class="logo-principale" alt="ATS">
                        ${iconaCommessaUrl ? `<img src="${iconaCommessaUrl}" class="icon-commessa" alt="Commessa">` : ''}
                    </div>
                    <div class="campo-data">${data}</div>
                    <div class="odp">${testoPrincipale}</div>
                    <div class="progressivo">${prog}</div>
                    <div class="campo"><div class="label">DESTINO</div><div class="valore">${location}</div></div>
                    <div class="campo"><div class="label">INDIRIZZO</div><div class="valore">${idscheda}</div></div>
                `;
            }
            anteprima.appendChild(et);
            idx++;
        }
    }
}


// RESET CAMPi
function resetCampi() {
    document.getElementById("data").value = new Date().toISOString().split('T')[0];
    document.getElementById("commessa").value = "";
    document.getElementById("odp").value = "";
    document.getElementById("location").value = "";
    document.getElementById("destino").value = "";
    document.getElementById("indirizzo").value = "";
    document.getElementById("palletColli").value = "";
    document.getElementById("anteprima").innerHTML = "";
}

// EVENTI INIZIALI
document.getElementById("commessa").addEventListener("change", () => {
    aggiornaListaDestinazioni();
    document.getElementById("destino").value = "";
    document.getElementById("indirizzo").value = "";
    genera();
});

cambiaFormato();
aggiornaListaDestinazioni();
genera();
// Adatta automaticamente le dimensioni @page quando cambi formato
function aggiornaPageSize() {
    const piccolo = document.querySelector('input[name="size"]:checked').value === "10x5";
    const height = piccolo ? "50mm" : "100mm";
    
    // Crea/inserisci il CSS per la stampa
    let style = document.getElementById("print-size-style");
    if (!style) {
        style = document.createElement("style");
        style.id = "print-size-style";
        document.head.appendChild(style);
    }
    
    style.innerHTML = `
        @media print {
            @page { size: 100mm ${height}; margin: 0; }
            html, body, .etichetta { 
                width: 100mm !important; 
                height: ${height} !important; 
                min-height: ${height} !important;
            }
            .etichetta.small { height: ${height} !important; }
        }
    `;
}

// Chiamala ogni volta che cambi formato o generi
document.querySelectorAll('input[name="size"]').forEach(r => {
    r.addEventListener("change", () => {
        cambiaFormato();
        aggiornaPageSize();
    });
});

// Prima stampa
aggiornaPageSize();

</script>
</body>
</html>
